!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-intl",["exports","@angular/core","@angular/common/http","rxjs","rxjs/operators"],factory):factory((global.ng=global.ng||{},global.ng.angularIntl={}),global.ng.core,global.ng.common.http,global.rxjs,global.rxjs.operators)}(this,function(exports,core,http,rxjs,operators){"use strict";var __assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},CONFIG=new core.InjectionToken("config"),LoaderService=function(){function LoaderService(http$$1,config){this.http=http$$1,this.config=config,this.path="/assets/languages/",this.extension=".json",this.path=config.path?config.path:this.path}return LoaderService.prototype.getFile=function(fileName){return this.http.get(this.path+fileName+this.extension)},LoaderService.decorators=[{type:core.Injectable}],LoaderService.ctorParameters=function(){return[{type:http.HttpClient},{type:void 0,decorators:[{type:core.Inject,args:[CONFIG]}]}]},LoaderService}(),CONSTANTS_EXIT="EXIT",TranslateService=function(){function TranslateService(http$$1,config){this.http=http$$1,this.config=config,this.translations={},this.translationsLoaded=new rxjs.BehaviorSubject(!1),this.matcher=function(key){return new RegExp("{{\\s?[\\b"+key+"\\b]*\\s?}}","gm")},this.loaderService=new LoaderService(http$$1,config)}return TranslateService.prototype.getBrowserLanguage=function(){var browserLanguage=window.navigator.languages?window.navigator.languages[0]:window.navigator.language;return-1!==browserLanguage.indexOf("-")&&(browserLanguage=browserLanguage.split("-")[0]),-1!==browserLanguage.indexOf("_")&&(browserLanguage=browserLanguage.split("_")[0]),browserLanguage},TranslateService.prototype.setDefault=function(fileName){var _this=this;this.defaultKey=fileName,this.defaultPrefix=fileName.split("-")[0],this.translations[this.defaultKey]?this.translationsLoaded.next(!0):(this.translationsLoaded.next(!1),this.loaderService.getFile(fileName).subscribe(function(translations){_this.translations[_this.defaultKey]=translations,_this.translationsLoaded.next(!0)}))},TranslateService.prototype.setOverride=function(fileName){var _this=this;this.overrideKey=fileName,this.translations[this.overrideKey]?this.translationsLoaded.next(!0):this.loaderService.getFile(fileName).subscribe(function(translations){_this.translations[_this.overrideKey]=translations,_this.translationsLoaded.next(!0)})},TranslateService.prototype.get=function(keyPaths){return this.translationsLoaded.pipe(operators.filter(Boolean),operators.switchMapTo(keyPaths instanceof Array?this.getAll(keyPaths):this.getOne(keyPaths)))},TranslateService.prototype.getByFileName=function(keyPaths,fileName){var _this=this,translationLoaded=new rxjs.Subject,defaultFileName=this.defaultPrefix+"-"+fileName.split("-")[1];return this.loaderService.getFile(fileName).pipe(function(file){return rxjs.combineLatest(file,_this.loaderService.getFile(defaultFileName))},operators.filter(function(_a){return-1===[_a[0],_a[1]].indexOf(void 0)}),operators.take(1)).subscribe(function(_a){var translations=_a[0],defaultTranslations=_a[1];_this.translations[fileName]=translations,_this.translations[defaultFileName]=defaultTranslations,translationLoaded.next(fileName)},function(){_this.loaderService.getFile(defaultFileName).pipe(operators.take(1)).subscribe(function(translations){_this.translations[defaultFileName]=translations,translationLoaded.next(defaultFileName)})}),translationLoaded.pipe(operators.switchMap(function(overrideFileName){return keyPaths instanceof Array?_this.getAll(keyPaths,overrideFileName,defaultFileName):_this.getOne(keyPaths,overrideFileName,defaultFileName)}))},TranslateService.prototype.getOne=function(keyPath,fileName,defaultKey){return void 0===fileName&&(fileName=this.overrideKey),void 0===defaultKey&&(defaultKey=this.defaultKey),rxjs.from([this.read(keyPath,{},fileName,defaultKey)])},TranslateService.prototype.getAll=function(keyPaths,fileName,defaultKey){var _this=this;return void 0===fileName&&(fileName=this.overrideKey),void 0===defaultKey&&(defaultKey=this.defaultKey),rxjs.of(keyPaths.reduce(function(acc,keyPath){return __assign({},acc,((_a={})[keyPath]=_this.read(keyPath,{},fileName,defaultKey),_a));var _a},{}))},TranslateService.prototype.read=function(keyPath,params,overrideKey,defaultKey){var _this=this;void 0===params&&(params={}),void 0===overrideKey&&(overrideKey=this.overrideKey),void 0===defaultKey&&(defaultKey=this.defaultKey);var value=CONSTANTS_EXIT,path=keyPath.split(".");return this.translations[overrideKey]?(value=this.readValue(path,this.translations[overrideKey]))===CONSTANTS_EXIT&&(value=this.readValue(path,this.translations[defaultKey])):this.translations[defaultKey]&&(value=this.readValue(path,this.translations[defaultKey])),Boolean(params)&&params!=={}&&(value=Object.keys(params).reduce(function(final,key){return final.replace(_this.matcher(key),params[key])},value)),value===CONSTANTS_EXIT?(console.warn("Unknown Key: ",keyPath),keyPath):value},TranslateService.prototype.readValue=function(path,translation){for(var length=path.length,i=0;i<length&&(translation=translation&&translation[path[i]]?translation[path[i]]:CONSTANTS_EXIT)!==CONSTANTS_EXIT;i++);return translation},TranslateService.prototype.isEquivalent=function(a,b){if(!Boolean(a)||!Boolean(b))return!1;var aProps=Object.getOwnPropertyNames(a),bProps=Object.getOwnPropertyNames(b);if(aProps.length!==bProps.length)return!1;for(var i=0;i<aProps.length;i++){var propName=aProps[i];if(a[propName]!==b[propName])return!1}return!0},TranslateService.decorators=[{type:core.Injectable}],TranslateService.ctorParameters=function(){return[{type:http.HttpClient},{type:void 0,decorators:[{type:core.Inject,args:[CONFIG]}]}]},TranslateService}(),TranslateDirective=function(){function TranslateDirective(element,translateService){this.element=element,this.translateService=translateService,this.unsubscribe=new rxjs.Subject,this.translationLoaded$=this.translateService.translationsLoaded.pipe(operators.takeUntil(this.unsubscribe))}return Object.defineProperty(TranslateDirective.prototype,"params",{set:function(params){this.translateService.isEquivalent(this.translateParams,params)||(this.translateParams=params,this.translateParams&&this.runOneCheck(this.keyPath,this.translateParams))},enumerable:!0,configurable:!0}),TranslateDirective.prototype.ngAfterViewInit=function(){this.keyPath=this.element.nativeElement.textContent?this.element.nativeElement.textContent.trim():"",this.element.nativeElement.textContent="",this.registerKeyChecker(this.keyPath)},TranslateDirective.prototype.ngOnDestroy=function(){this.unsubscribe.next(),this.unsubscribe.complete()},TranslateDirective.prototype.registerKeyChecker=function(keyPath){var _this=this;this.translationLoaded$.subscribe(function(isLoaded){return _this.doCheck(isLoaded,keyPath,_this.translateParams)})},TranslateDirective.prototype.runOneCheck=function(keyPath,params){var _this=this;keyPath&&this.translationLoaded$.pipe(operators.take(1)).subscribe(function(isLoaded){return _this.doCheck(isLoaded,keyPath,params)})},TranslateDirective.prototype.doCheck=function(isLoaded,keyPath,params){if(isLoaded){var readValue=""!==keyPath?this.translateService.read(keyPath,params):"";this.element.nativeElement.textContent=readValue===keyPath?"":readValue}},TranslateDirective.decorators=[{type:core.Directive,args:[{selector:"[translate]"}]}],TranslateDirective.ctorParameters=function(){return[{type:core.ElementRef},{type:TranslateService}]},TranslateDirective.propDecorators={params:[{type:core.Input,args:["translate"]}]},TranslateDirective}(),TranslatePipe=function(){function TranslatePipe(translateService){this.translateService=translateService,this.translation="",this.unsubscribe=new rxjs.Subject,this.translationLoaded$=translateService.translationsLoaded.pipe(operators.filter(Boolean),operators.takeUntil(this.unsubscribe))}return TranslatePipe.prototype.transform=function(val,args){var _this=this;return this.translationLoaded$.subscribe(function(){var readValue=val?_this.translateService.read(val,args):"";_this.translation=readValue===val?_this.translation:readValue}),this.translation},TranslatePipe.prototype.ngOnDestroy=function(){this.unsubscribe.next(),this.unsubscribe.complete()},TranslatePipe.decorators=[{type:core.Pipe,args:[{name:"translate",pure:!1}]}],TranslatePipe.ctorParameters=function(){return[{type:TranslateService}]},TranslatePipe}(),TranslateModule=function(){function TranslateModule(){}return TranslateModule.forRoot=function(config){return void 0===config&&(config={}),{ngModule:TranslateModule,providers:[TranslateService,LoaderService,{provide:CONFIG,useValue:config}]}},TranslateModule.forChild=function(){return{ngModule:TranslateModule}},TranslateModule.decorators=[{type:core.NgModule,args:[{imports:[http.HttpClientModule],declarations:[TranslateDirective,TranslatePipe],exports:[TranslateDirective,TranslatePipe]}]}],TranslateModule}(),translations={"default-en":{BODY:{KNOWN_KEY:"Known key example"}}},LoaderServiceMock={path:"/assets/language",extension:".json",http:null,config:null,getFile:function(key){return rxjs.of(translations[key])}};exports.TranslateModule=TranslateModule,exports.TranslateService=TranslateService,exports.TranslateDirective=TranslateDirective,exports.TranslatePipe=TranslatePipe,exports.LoaderService=LoaderService,exports.LoaderServiceMock=LoaderServiceMock,exports.Éµa=CONFIG,Object.defineProperty(exports,"__esModule",{value:!0})});